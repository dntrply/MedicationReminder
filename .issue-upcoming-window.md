Summary
In Timeline, if a medication is tapped well before the scheduled time (e.g., it’s 2:00 PM and dose is at 6:00 PM), the action dialog currently shows the full Taken / Snooze / Skip palette. This enables actions that don’t make sense yet (Taken, Snooze). We should gate actions by a lead‑time window: only show/enable actions starting X minutes before the scheduled time. Allow “Skip” as an early opt‑out. Keep overdue doses (previous day) fully actionable.

Scenario
- Scheduled time: Today 6:00 PM
- Current time: Today 2:00 PM (4 hours early)
- Current behavior: Action dialog shows Taken, Snooze, Skip.
- Problem: User can prematurely mark Taken or Snooze before any reminder window has begun.

Proposed Behavior
- Introduce an “upcoming window” X minutes before the scheduled time (default X = 60 minutes; configurable later if needed).
- Before X minutes:
  - Do not show or disable: Taken, Snooze.
  - Optional: Keep Skip available (user knows they will skip today). Alternatively, require within X window; product decision.
  - Show a friendly “upcoming” panel: large medication image, scheduled time, audio play button if available, and a short encouraging message (e.g., “This dose is coming up soon. Thanks for checking in!”).
- Within X minutes of scheduled time (and after the time):
  - Show full action palette (Taken, Snooze, Skip), subject to other rules (e.g., disallowing Snooze/Skip after SKIPPED; see Issue #11).
- Special case (previous day):
  - If the occurrence is from a previous day (overdue), the full action palette should remain available regardless of X (user needs to resolve yesterday’s dose).

Notes & Rationale
- Prevents accidental early “Taken” or “Snooze” that desynchronizes schedule and reduces reliability for elderly users.
- Reinforces recognition: the enlarged image + time and a gentle message improves confidence without inviting premature action.
- Keeps early “Skip” available as a pragmatic choice for known conflicts.

Implementation Notes
- Primary location: TimelineView action dialog enablement and content.
  - File: app/src/main/java/com/medreminder/app/ui/TimelineView.kt (dialog where buttons are created).
  - Compute minutesUntilDose from now vs. that slot’s scheduled hour:minute (same day). If minutesUntilDose > X → show upcoming panel (no Taken/Snooze; optional Skip only). Else → show full actions.
  - Ensure previous‑day (or older) occurrences bypass this and show full actions.
- Consider extracting a shared “MedicationActionDialogUpcoming” composable for the upcoming panel (image, time, audio play button, friendly copy) to reuse across screens.
- Optionally add a setting for X later (not required now).

Acceptance Criteria
- Tapping a medication earlier than X minutes before its scheduled time shows the “upcoming” panel instead of the full action buttons.
- Within X minutes (and any time after) shows the full action palette.
- Overdue (previous day) occurrences always show full action palette.
- If early Skip is allowed, it remains enabled before X; if not, it is hidden/disabled per final decision.
- Works with other guards: after SKIPPED is recorded for this occurrence, Snooze/Skip disabled/hidden (Issue #11).
- Tested with font scaling and screen sizes; image and text remain legible.

Open Questions
- Should Skip be available before X? (Initial proposal: yes.)
- Value of X: start at 60 minutes; consider making it user‑configurable later.

References
- Timeline action dialog code: app/src/main/java/com/medreminder/app/ui/TimelineView.kt
- Related: Issue #11 (Disallow Snooze/Skip after SKIPPED).
